<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Se7enZçš„åšå®¢ - æŠ€æœ¯æ–‡ç« å’Œç”Ÿæ´»éšç¬”">
    <title>Blog | Se7enZ</title>
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/style.css">
    <script>
        // é˜²æ­¢ä¸»é¢˜åˆ‡æ¢é—ªçƒï¼šåœ¨é¡µé¢æ¸²æŸ“å‰ç«‹å³åº”ç”¨ä¸»é¢˜
        (function() {
            try {
                const theme = localStorage.getItem('theme');
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark-mode');
                    // å¦‚æœ body å·²åŠ è½½ï¼Œä¹Ÿç«‹å³æ·»åŠ ç±»
                    if (document.body) {
                        document.body.classList.add('dark-mode');
                    }
                }
            } catch (e) {}
        })();
    </script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="header"></div>

    <div class="container" id="app">
        <div style="flex: 0 0 240px; display: flex; flex-direction: column; gap: 20px; align-self: flex-start; position: sticky; top: 100px;">
            <aside class="sidebar" style="position: static;">
                <h3>æ–‡ç« åˆ†ç±»</h3>
                <ul>
                    <li 
                        class="sidebar-item" 
                        :class="{ active: selectedCategory === '' }"
                        @click="selectedCategory = ''"
                    >
                        # å…¨éƒ¨æ–‡ç«  ({{ posts.length }})
                    </li>
                    <li 
                        v-for="cat in categories" 
                        :key="cat"
                        class="sidebar-item"
                        :class="{ active: selectedCategory === cat }"
                        @click="selectedCategory = cat"
                    >
                        # {{ cat }} ({{ getCount(cat) }})
                    </li>
                </ul>
            </aside>
            
            <aside class="sidebar" style="position: static; background: linear-gradient(135deg, rgba(9, 132, 227, 0.08) 0%, rgba(108, 92, 231, 0.08) 100%); border: 1px solid rgba(9, 132, 227, 0.15);">
                <div style="padding: 20px 10px;">
                    <p style="text-align: center; color: var(--accent-color); font-style: italic; font-size: 1.4rem; font-weight: 600; margin: 0; line-height: 1.8; letter-spacing: 2px;">
                        Stay Hungry, Stay Foolish
                    </p>
                </div>
            </aside>
        </div>

        <main>
            <div class="card blog-search-container">
                <input 
                    type="text" 
                    v-model="searchQuery" 
                    placeholder="è¾“å…¥å…³é”®è¯æœç´¢..." 
                    class="blog-search-input"
                >
            </div>
            <div v-if="loading" class="card text-center">åŠ è½½ä¸­...</div>
            
            <section v-else>
                <article class="card fade-in" v-for="post in paginatedPosts" :key="post.id">
                    <div class="post-card-header">
                        <h2 class="post-card-title">{{ post.title }}</h2>
                        <span class="post-category-badge-inline">
                            {{ post.coreWord }}
                        </span>
                    </div>
                    <p class="post-meta-inline">ğŸ“… {{ post.date }}</p>
                    <p v-if="post.excerpt" class="post-excerpt">{{ post.excerpt }}</p>
                    <a :href="'post-detail.html?id=' + post.id" class="project-link post-read-more">
                        é˜…è¯»å…¨æ–‡ â†’
                    </a>
                </article>

                <div v-if="filteredPosts.length === 0" class="card text-center loading-skeleton">
                    æ²¡æœ‰æ‰¾åˆ°åŒ¹é…æ–‡ç« 
                </div>

                <div v-if="totalPages > 1" class="pagination-container">
                    <button 
                        class="theme-toggle" 
                        @click="currentPage--" 
                        :disabled="currentPage === 1"
                    >
                        ä¸Šä¸€é¡µ
                    </button>
                    <span class="pagination-info">{{ currentPage }} / {{ totalPages }}</span>
                    <button 
                        class="theme-toggle" 
                        @click="currentPage++" 
                        :disabled="currentPage === totalPages"
                    >
                        ä¸‹ä¸€é¡µ
                    </button>
                </div>
            </section>
        </main>
    </div>

    <div id="footer"></div>

    <script src="js/main.js"></script>
    <script>
        const { createApp, ref, onMounted, computed, watch } = Vue;

        createApp({
            setup() {
                const posts = ref([]);
                const loading = ref(true);
                const selectedCategory = ref("");
                
                // æœç´¢é€»è¾‘ç›¸å…³
                const searchQuery = ref("");
                const debouncedQuery = ref("");
                let timeoutId = null;

                // åˆ†é¡µç›¸å…³
                const currentPage = ref(1);
                const pageSize = 5; // æ¯é¡µæ˜¾ç¤º 5 ç¯‡

                // ç›‘å¬æœç´¢è¾“å…¥å®æ–½é˜²æŠ–
                watch(searchQuery, (newVal) => {
                    clearTimeout(timeoutId);
                    timeoutId = setTimeout(() => {
                        debouncedQuery.value = newVal;
                        currentPage.value = 1; // æœç´¢æ—¶é‡ç½®é¡µç 
                    }, 300);
                });

                // ç›‘å¬åˆ†ç±»åˆ‡æ¢é‡ç½®é¡µç 
                watch(selectedCategory, () => {
                    currentPage.value = 1;
                });

                onMounted(async () => {
                    try {
                        const res = await fetch('data/posts.json');
                        posts.value = await res.json();
                    } catch (err) {
                        console.error("åŠ è½½æ–‡ç« åˆ—è¡¨å¤±è´¥", err);
                    } finally {
                        loading.value = false;
                    }
                });

                const categories = computed(() => {
                    const allCats = posts.value.map(p => p.category);
                    return [...new Set(allCats)];
                });

                const getCount = (cat) => {
                    return posts.value.filter(p => p.category === cat).length;
                };

                // æ ¸å¿ƒè¿‡æ»¤é€»è¾‘ï¼šåŸºäºåˆ†ç±»å’Œé˜²æŠ–åçš„æœç´¢è¯
                const filteredPosts = computed(() => {
                    return posts.value.filter(post => {
                        const matchesCat = selectedCategory.value === "" || post.category === selectedCategory.value;
                        const query = debouncedQuery.value.toLowerCase();
                        const matchesSearch = post.title.toLowerCase().includes(query) || 
                                            (post.excerpt && post.excerpt.toLowerCase().includes(query));
                        return matchesCat && matchesSearch;
                    });
                });

                // åˆ†é¡µåˆ‡ç‰‡é€»è¾‘
                const paginatedPosts = computed(() => {
                    const start = (currentPage.value - 1) * pageSize;
                    const end = start + pageSize;
                    return filteredPosts.value.slice(start, end);
                });

                // æ€»é¡µæ•°è®¡ç®—
                const totalPages = computed(() => {
                    return Math.ceil(filteredPosts.value.length / pageSize) || 1;
                });

                return { 
                    posts, loading, searchQuery, selectedCategory, 
                    categories, getCount, filteredPosts, 
                    paginatedPosts, currentPage, totalPages 
                };
            }
        }).mount('#app');
    </script>
</body>
</html>